<!-- This code snippet is an HTML document that represents a theme editor interface for a software called
"picoTracker Theme Studio v1.0". It includes various elements such as windows, buttons, input
fields, a preview monitor, and a gallery section. -->
<!DOCTYPE html>
<html>
<head>
    <title>picoTracker Theme Studio v1.0</title>
    <style>
        :root { --win-bg: #c0c0c0; --win-border-light: #ffffff; --win-border-dark: #808080; --win-blue: #000080; }
        body { background: #008080; font-family: sans-serif; display: flex; gap: 20px; padding: 20px; margin: 0; font-size: 12px; }
        .window { background: var(--win-bg); border: 2px solid; border-color: var(--win-border-light) var(--win-border-dark) var(--win-border-dark) var(--win-border-light); padding: 3px; box-shadow: 1px 1px 0 #000; }
        .title-bar { background: var(--win-blue); color: white; padding: 3px 6px; font-weight: bold; display: flex; justify-content: space-between; margin-bottom: 10px; }
        .content { padding: 10px; }
        .row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
        input[type="text"] { border: 2px solid; border-color: var(--win-border-dark) var(--win-border-light) var(--win-border-light) var(--win-border-dark); padding: 2px; outline: none; }
        button { background: var(--win-bg); border: 2px solid; border-color: var(--win-border-light) var(--win-border-dark) var(--win-border-dark) var(--win-border-light); padding: 4px 10px; cursor: pointer; font-weight: bold; }
        button:active { border-color: var(--win-border-dark) var(--win-border-light) var(--win-border-light) var(--win-border-dark); }
        .preview {
            width: 520px;
            height: 420px;
            background: var(--BACKGROUND);
            color: var(--FOREGROUND);
            border: 4px solid #000;
            position: relative;
            padding: 8px 14px;
            overflow: hidden;
            font-family: "DejaVu Sans Mono", "Courier New", monospace;
            font-size: 18px;
            line-height: 1.0;
            letter-spacing: 0;
            white-space: pre;
        }
        .preview::after { content: ""; position: absolute; top:0; left:0; width:100%; height:100%; background: linear-gradient(rgba(18,16,16,0) 50%, rgba(0,0,0,0.1) 50%); background-size: 100% 4px; pointer-events: none; }
        .preview .blue { color: var(--INFOCOLOR); }
        .preview .green { color: #00dd66; }
        .preview .cursor { background: var(--HICOLOR1); color: var(--BACKGROUND); padding: 0 2px; }
        .gallery { margin-top: 15px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; }
        .g-item { border: 1px solid #000; padding: 5px; cursor: pointer; font-size: 10px; text-align: center; }
    </style>
</head>
<body>
    <div class="window" style="width: 350px;">
        <div class="title-bar"><span>Theme_Editor.exe</span></div>
        <div class="content">
            <input type="file" id="fileIn" style="display:none" onchange="upload()">
            <button onclick="document.getElementById('fileIn').click()" style="width:100%">IMPORT .PTT</button>
            <hr>
            <form action="/download" method="post" id="f">
                <div class="row">Name: <input type="text" name="theme_name" id="tn" value="win95"></div>
                {% for k, v in colors.items() %}
                <div class="row">{{ k }}: <input type="color" name="{{ k }}" id="in_{{ k }}" value="{{ v }}" oninput="up('{{ k }}', this.value)"></div>
                {% endfor %}
                <button type="button" onclick="rand()" style="width:100%; margin: 10px 0;">RANDOMIZE</button>
                <button type="submit" style="width:100%; background:#28a745; color:white">GENERATE .PTT</button>
            </form>
        </div>
    </div>

    <div style="display:flex; flex-direction:column; gap:20px;">
        <div class="window">
            <div class="title-bar"><span>Preview_Monitor</span></div>
            <div class="preview" id="pv">
<span class="blue">song sad-fog</span>                         <span class="green">[c++f]</span>

{% for row in tracker_rows %}<span class="blue">{{ row }}</span>  {% if loop.first %}<span class="cursor blue">00</span>{% else %}<span class="blue">--</span>{% endif %}  <span class="blue">--</span>  <span class="blue">--</span>  <span class="blue">--</span>  <span class="blue">--</span>  <span class="blue">--</span>  <span class="blue">--</span>  <span class="blue">--</span>
{% endfor %}
<span class="blue">D</span>
<span class="blue">P   G</span>
<span class="blue">S C P I</span>
<span class="blue">   T T</span>
            </div>
        </div>
        <div class="window">
            <div class="title-bar"><span>Gallery</span></div>
            <div class="content">
                <button onclick="saveG()" style="width:100%">SAVE TO GALLERY</button>
                <div id="gal" class="gallery"></div>
            </div>
        </div>
    </div>

    <script>
        const up = (k, v) => document.getElementById('pv').style.setProperty('--' + k, v);
        async function rand() {
            const r = await fetch('/randomize'); const c = await r.json();
            for(let k in c) { document.getElementById('in_'+k).value = c[k]; up(k, c[k]); }
        }
        async function upload() {
            const fd = new FormData(); fd.append('file', document.getElementById('fileIn').files[0]);
            const r = await fetch('/import', {method:'POST', body:fd}); const c = await r.json();
            for(let k in c) { document.getElementById('in_'+k).value = c[k]; up(k, c[k]); }
        }
        function saveG() {
            let g = JSON.parse(localStorage.getItem('g')||'[]');
            let c = {}; document.querySelectorAll('input[type="color"]').forEach(i => c[i.name]=i.value);
            g.push({n:document.getElementById('tn').value, c});
            localStorage.setItem('g', JSON.stringify(g)); renderG();
        }
        function renderG() {
            const d = document.getElementById('gal'); d.innerHTML = '';
            JSON.parse(localStorage.getItem('g')||'[]').forEach((t, i) => {
                let div = document.createElement('div'); div.className = 'g-item';
                div.style.background = t.c.BACKGROUND; div.style.color = t.c.FOREGROUND;
                div.innerHTML = t.n; div.onclick = () => {
                    for(let k in t.c) { document.getElementById('in_'+k).value = t.c[k]; up(k, t.c[k]); }
                    document.getElementById('tn').value = t.n;
                };
                d.appendChild(div);
            });
        }
        window.onload = () => { document.querySelectorAll('input[type="color"]').forEach(i => up(i.name, i.value)); renderG(); };
    </script>
</body>
</html>
